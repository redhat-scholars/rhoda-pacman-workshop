<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Connecting to a Database :: Deploy Pacman using Red Hat OpenShift Database Access</title>
    <link rel="canonical" href="https://redhat-scholars.github.io/course-template/rhoda-pacman-workshop/pacman-java-databases.html">
    <link rel="prev" href="pacman-java.html">
    <link rel="next" href="pacman-application-health.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-scholars.github.io/course-template">Deploy Pacman using Red Hat OpenShift Database Access</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rhoda-pacman-workshop" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-workshop-summary.html">Workshop Summary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-environment.html">OpenShift Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html">Explore OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-explore.html#the_web_console">The Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html#command_line_interface">Command Line Interface</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="common-explore.html#download_openshift_cli">Download OpenShift CLI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="common-explore.html#use_web_terminal">Web Terminal</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html#connect_to_the_cluster_with_cli">Connect to the OpenShift Cluster from CLI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="common-explore.html#working_with_proxies">Working with proxies</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="prerequisites.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="projects.html">Projects</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="projects.html#create_your_first_project">Create your First Project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-pacman-architecture.html">Pacman Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pacman-java.html">Pacman App</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java.html#source_to_image">Background: Source-to-Image (S2I)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pacman-java.html#creating_java_application">Exercise: Creating a Pacman application</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pacman-java.html#add_to_project">Add to Project</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pacman-java.html#using_application_code_on_git_server">Using Application Code on a Git Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="pacman-java.html#build_code_on_openshift">Build the Code on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pacman-java-databases.html">Connecting to a Database</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#storage">Background: Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#challenges_dbaas">Background: DBaaS &amp; Present Challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#sol_rh_dbaas">Background: Red Hat Solution</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#sol_rh_dbaas">Background: Service binding libraries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#deploy_mongodb">Exercise: Deploy MongoDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#access_mongodb">Exercise: Accessing the database access menu for configuring and monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#find_mongodb_creds">Exercise: Find your MongoDB Atlas account credentials</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#access_dbaas_console">Exercise: Accessing the developer workspace and adding a database instance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#explore_rhoda_magic">Exercise: Navigate through Data Services Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#play_pacman">Exercise: Play Pacman and save your high scores</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pacman-application-health.html">Application Healthchecks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-application-health.html#add_health_checks">Exercise: Add Health Checks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pacman-java-codechanges-github.html">Webhooks with OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github.html#prerequisite_github_account">Prerequisite: GitHub Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github.html#webhooks">Webhooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github.html#webhooks_with_openshift">Webhooks with OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github.html#configuring_github_webhooks">Exercise: Configuring GitHub Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github.html#using_github_webhooks">Exercise: Using GitHub Web Hooks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pacman-java-codechanges-github-actions.html">GitHub Actions with OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github-actions.html#disable_github_webhook">Disable GitHub Webhook</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github-actions.html#disable_openshift_triggers">Disable OpenShift Triggers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github-actions.html#configure_github_action">Configure GitHub Action</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github-actions.html#add_github_action">Add GitHub Action</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-codechanges-github-actions.html#enable_openshift_triggers">Enable OpenShift Triggers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pacman-java-pipeline.html">Continuous Integration and Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline.html#install_openshift_pipelines_from_operatorhub">Install OpenShift Pipelines from OperatorHub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline.html#understanding_tekton">Understanding Tekton</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline.html#create_your_pipeline">Create Your Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline.html#run_the_pipeline">Run the Pipeline</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="pacman-java-pipeline-codechanges-github.html">Webhooks with Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline-codechanges-github.html#prerequisite_github_account">Prerequisite: GitHub Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline-codechanges-github.html#webhooks">Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline-codechanges-github.html#adding_triggers_to_your_pipeline">Adding Triggers to your Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline-codechanges-github.html#configuring_github_webhooks">Exercise: Configuring GitHub Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pacman-java-pipeline-codechanges-github.html#using_github_webhooks">Exercise: Using GitHub Web Hooks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-further-resources.html">Further Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-workshop-links.html">Workshop Links</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#openshift_cluster_url">OpenShift Cluster URL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#workshop_guides">Workshop Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#web_terminal">Web terminal</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#git_server">Git Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Deploy Pacman using Red Hat OpenShift Database Access</a></li>
    <li><a href="pacman-java-databases.html">Connecting to a Database</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/rhoda-pacman-workshop/edit/master/documentation/modules/ROOT/pages/pacman-java-databases.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Connecting to a Database</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this section we will deploy and connect a MongoDB database where the
<code>pacman</code> application will store location information.</p>
</div>
<div class="paragraph">
<p>Finally, we will mark the <code>pacman</code> application as a backend for the map
visualization tool, so that it can be dynamically discovered by the <code>parksmap</code>
component using the OpenShift discovery mechanism and the map will be displayed
automatically.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/roadshow-app-architecture-nationalparks-2.png" alt="Application architecture" width="800">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="storage"><a class="anchor" href="#storage"></a>Background: Storage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most useful applications are "stateful" or "dynamic" in some way, and this is
usually achieved with a database or other data storage. In this lab we are
going to add MongoDB to our <code>pacman</code> application and then rewire it to
talk to the database using environment variables via a secret.</p>
</div>
<div class="paragraph">
<p>We are going to use the MongoDB image that is included with OpenShift.</p>
</div>
<div class="paragraph">
<p>By default, this will use <strong>EmptyDir</strong> for data storage, which means if the <strong>Pod</strong>
disappears the data does as well. In a real application you would use
OpenShift&#8217;s persistent storage mechanism to attach real-world storage (NFS,
Ceph, EBS, iSCSI, etc) to the <strong>Pods</strong> to give them a persistent place to store their
data.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="challenges_dbaas"><a class="anchor" href="#challenges_dbaas"></a>Background: DBaaS &amp; Present Challenges</h2>
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="_images/challenge.png" alt="DBaaS &amp; Present Challenges" width="800">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol_rh_dbaas"><a class="anchor" href="#sol_rh_dbaas"></a>Background: Red Hat Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>More efficient connection, DB utilization
Faster and easier self-service for developers
Centralized monitoring, consistent control plane for admins</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/solution.png" alt="Red Hat Solution" width="800">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bg_sb_lib"><a class="anchor" href="#bg_sb_lib"></a>Background: Service binding libraries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Kubernetes service binding feature was introduced to bring consistency to the way secrets are shared for connecting applications to external services, such as REST APIs, databases, and many other services.
OpenShift Database Access leverages the service binding feature to bring a low-touch administrative experience to provisioning, and managing access to external database services.
The service binding feature enables developers to connect their applications to database services with a consistent, and predictable experience.
Specifically, a service binding creates a volume on the application pod, and organizes the information to make a connection to the database in a directory structure.
The volume mount point is exposed as an environment variable. Developer frameworks, such as Quarkus, are service binding aware, and can automatically connect to a database using this exposed workload information without needing to embed database connection information in the application source code.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prereq_rhoda"><a class="anchor" href="#prereq_rhoda"></a>Prerequisites: Things to Do befor configuring MongoDB Atlas</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to run the lab in your cluster, you need to meet the requirements discussed below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top"><strong>Component</strong></th>
<th class="tableblock halign-center valign-top"><strong>Version</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://www.openshift.com/try">OpenShift</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>{openshift-version}</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the following modules you will find out other prerequisites when needed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy_mongodb"><a class="anchor" href="#deploy_mongodb"></a>Exercise: Deploy MongoDB</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="access_mongodb"><a class="anchor" href="#access_mongodb"></a>Exercise : Accessing the database access menu for configuring and monitoring</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="find_mongodb_creds"><a class="anchor" href="#find_mongodb_creds"></a>Exercise: Find your MongoDB Atlas account credentials</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="access_dbaas_console"><a class="anchor" href="#access_dbaas_console"></a>Exercise: Accessing the developer workspace and adding a database instance</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="explore_rhoda_magic"><a class="anchor" href="#explore_rhoda_magic"></a>Exercise: Navigate through Data Services Console</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="exploring_openshift_magic"><a class="anchor" href="#exploring_openshift_magic"></a>Exercise: Exploring OpenShift Magic</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="play_pacman"><a class="anchor" href="#play_pacman"></a>Exercise: Play Pacman and save your high scores</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As soon as we attached the Secret to the <strong>Deployment</strong>, some
magic happened. OpenShift decided that this was a significant enough change to
warrant updating the internal version number of the <strong>ReplicaSet</strong>. You
can verify this by looking at the output of <code>oc get rs</code>:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                       DESIRED   CURRENT   READY   AGE
nationalparks-58bd4758fc   0         0         0       4m58s
nationalparks-7445576cd9   0         0         0       6m42s
nationalparks-789c6bc4f4   1         1         1       41s
parksmap-57df75c46d        1         1         1       8m24s
parksmap-65c4f8b676        0         0         0       18m</code></pre>
</div>
</div>
<div class="paragraph">
<p>We see that the DESIRED and CURRENT number of instances for the current deployment. The desired and current number of the other instances are 0.
This means that OpenShift has gracefully torn down our "old" application and
stood up a "new" instance.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data_data_everywhere"><a class="anchor" href="#data_data_everywhere"></a>Exercise: Data, Data, Everywhere</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have a database deployed, we can again visit the <code>nationalparks</code> web
service to query for data:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">https://nationalparks-%PROJECT%.%CLUSTER_SUBDOMAIN%/ws/data/all</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the result?</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where&#8217;s the data? Think about the process you went through. You deployed the
application and then deployed the database. Nothing actually loaded anything
<strong>INTO</strong> the database, though.</p>
</div>
<div class="paragraph">
<p>The application provides an endpoint to do just that:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">https://nationalparks-%PROJECT%.%CLUSTER_SUBDOMAIN%/ws/data/load</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the result?</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Items inserted in database: 2893</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you then go back to <code>/ws/data/all</code> you will see tons of JSON data now.
That&#8217;s great. Our parks map should finally work!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There are some errors reported with browsers like Firefox 54 that don&#8217;t properly parse the resulting JSON. It&#8217;s
a browser problem, and the application is working properly.
</td>
</tr>
</table>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">https://parksmap-%PROJECT%.%CLUSTER_SUBDOMAIN%</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hmm&#8230;&#8203; There&#8217;s just one thing. The main map <strong>STILL</strong> isn&#8217;t displaying the parks.
That&#8217;s because the front end parks map only tries to talk to services that have
the right <strong>Label</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You are probably wondering how the database connection magically started
working? When deploying applications to OpenShift, it is always best to use
environment variables, secrets, or configMaps to define connections to dependent systems.  This allows
for application portability across different environments.  The source file that
performs the connection as well as creates the database schema can be viewed
here:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">http://www.github.com/openshift-roadshow/nationalparks/blob/master/src/main/java/com/openshift/evg/roadshow/parks/db/MongoDBConnection.java#L44-l48</code></pre>
</div>
</div>
<div class="paragraph">
<p>In short summary: By referring to bindings to connect to services
(like databases), it can be trivial to promote applications throughout different
lifecycle environments on OpenShift without having to modify application code.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="working_with_labels"><a class="anchor" href="#working_with_labels"></a>Exercise: Working With Labels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We explored how a <strong>Label</strong> is just a key=value pair earlier when looking at
<strong>Services</strong> and <strong>Routes</strong> and <strong>Selectors</strong>. In general, a <strong>Label</strong> is simply an
arbitrary key=value pair. It could be anything.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pizza=pepperoni</code></p>
</li>
<li>
<p><code>pet=dog</code></p>
</li>
<li>
<p><code>openshift=awesome</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the case of the parks map, the application is actually querying the OpenShift
API and asking about the <strong>Routes</strong> and <strong>Services</strong> in the project. If any of them have a
<strong>Label</strong> that is <code>type=parksmap-backend</code>, the application knows to interrogate
the endpoints to look for map data.
You can see the code that does this
<a href="https://github.com/openshift-roadshow/parksmap-web/blob/master/src/main/java/com/openshift/evg/roadshow/rest/RouteWatcher.java#L20">here</a>.</p>
</div>
<div class="paragraph">
<p>Fortunately, the command line provides a convenient way for us to manipulate
labels. <code>describe</code> the <code>nationalparks</code> service:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc describe route nationalparks</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Name:                   nationalparks
Namespace:              %PROJECT%
Created:                2 hours ago
Labels:                 app=workshop
                        app.kubernetes.io/component=nationalparks
                        app.kubernetes.io/instance=nationalparks
                        app.kubernetes.io/name=java
                        app.kubernetes.io/part-of=workshop
                        app.openshift.io/runtime=java
                        app.openshift.io/runtime-version=11
                        component=nationalparks
                        role=backend
Annotations:            openshift.io/host.generated=true
Requested Host:         nationalparks-%PROJECT%.%CLUSTER_SUBDOMAIN%
                        exposed on router router 2 hours ago
Path:                   &lt;none&gt;
TLS Termination:        &lt;none&gt;
Insecure Policy:        &lt;none&gt;
Endpoint Port:          8080-tcp

Service:                nationalparks
Weight:                 100 (100%)
Endpoints:              10.1.9.8:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>You see that it already has some labels. Now, use <code>oc label</code>:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc label route nationalparks type=parksmap-backend</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see something like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">route.route.openshift.io/nationalparks labeled</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you check your browser now:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">https://parksmap-%PROJECT%.%CLUSTER_SUBDOMAIN%/</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-databases-new-parks.png" alt="MongoDB">
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll notice that the parks suddenly are showing up. That&#8217;s really cool!</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="pacman-java.html">Pacman App</a></span>
  <span class="next"><a href="pacman-application-health.html">Application Healthchecks</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
